JVM

자바의 개발의 시작은 어떤 OS에서든지 구동가능한 프로그램을 만드는 것이 목적이였다. 이 목적을 달성하기 위해서는 어떤 OS에서든지 구동이 가능해야하는데
JVM은 이를 가능하도록 만들어준다. JVM이 모든 OS에서 구동이 가능한 이유는 JVM은 메모리에 할당되어서 해당 코드를 바이트 코드로 변환시켜서 활용하기 때문이다.
바이트 코드로 변환된 프로그램은 class Loader에 의해 일정한 기준에 거쳐서 로드된다.

JVM의 전체적인 흐름은 다음과 같다.
여러 클래스의 집합으로 이루어진 Java source가 존재하는데, 이 소스코드를 Java 컴파일러가 읽어서 바이트코드로 변환한다. 이렇게 변환된 클래스의 집합은
Class Loader에 의해서 바이트 코드를 JVM에 로딩되는데, 이렇게 로딩된 바이트 코드는 Execution Engine을 통해서 해석된다. 

Execution Engine에는 interpreter, JIT Compiler, Garbage Collector 이 존재하는데, 인터프리터는 바이트 코드를 한 줄씩 읽어와서 저수준 언어로 번역한다.
이때 자주 호출되어 핫스팟에 들어가게된 메서드는 JIT에서 로드하게 되는데, 이곳에서 실행 시점에 직접 이해할 수 있는 네이티브 언어로 변환된다.
JIT C1에 들어가게되면 빠른 컴파일과 낮은 수준의 최적화로 코드 캐시에 저장되며, 더 자주 호출되거나 중요도가 높아지면 C2에서 컴파일없이 실행되도록 설정된다.

이렇게 해석된 바이트코드는 Runtime Data Area에 배치되어 실행되는데, 이곳에 있는 Heap 영역이 바로 객체를 생성하고 사용할 수 있는 메모리라고 볼 수 있다.


이렇게 로드된 클래스들은 번역 과정을 거치는데 이 번역과정은 컴파일러와 인터프리터가 담당한다.
컴파일러에서 자주 쓰이는 부분들은 인터프리터로 넘어가서 인터프리터에서 캐싱을 통해 자주 쓰이는 데이터들을 쉽게 사용할 수 있다.

![](https://velog.velcdn.com/images/sonomoo/post/768041ca-d7c8-4e51-bd65-4cadec7aeccc/image.jpg)
